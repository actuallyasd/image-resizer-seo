<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SEO + Analytics Report – bestimageresizer.com</title>

  <style>
    :root{
      --bg:#121212; --panel:#1c1c1e; --panel-2:#222225;
      --ink:#f5f5f7; --ink-2:#cfcfd3; --muted:#9c9ca3;
      --blue:#0a84ff; --green:#30d158; --amber:#ffd60a; --red:#ff453a; --purple:#7a7aff;
      --grid:#2c2c2e; --shadow:0 8px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:20px; font-family:-apple-system,BlinkMacSystemFont,"San Francisco",Arial,sans-serif;
      background:var(--bg); color:var(--ink);
    }
    body::after{
      content:""; position:fixed; inset:0; pointer-events:none;
      background-image:radial-gradient(rgba(255,255,255,.025) 1px, transparent 1px);
      background-size:3px 3px;
    }

    h1{ text-align:center; margin:0 0 28px; letter-spacing:.2px; }

    .tabs{ display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-bottom:20px; }
    .tab{
      padding:10px 18px; border-radius:12px; background:#1e1e1e; color:var(--ink);
      cursor:pointer; transition:.25s; user-select:none;
    }
    .tab:hover{ transform:translateY(-1px); }
    .tab.active{ background:var(--blue); color:#fff; box-shadow:0 6px 18px rgba(10,132,255,.35); }

    .content{ display:none; background:var(--panel); border-radius:16px; padding:24px; box-shadow:var(--shadow); animation:fade .35s ease; }
    .content.active{ display:block; }
    @keyframes fade{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }

    .subtabs{ display:flex; gap:8px; margin:10px 0 14px; flex-wrap:wrap; }
    .subtab{
      padding:6px 12px; border-radius:9px; background:#2c2c2e; color:var(--ink);
      cursor:pointer; transition:.2s;
    }
    .subtab.active{ background:var(--green); color:#fff; box-shadow:0 6px 14px rgba(48,209,88,.35); }
    .subcontent{ display:none; }
    .subcontent.active{ display:block; }

    iframe{ width:100%; height:520px; border:none; border-radius:12px; background:#2c2c2e; margin:12px 0 22px; box-shadow:var(--shadow); }
    iframe.doc-iframe{ height:80vh !important; background:transparent; box-shadow:none; border-radius:12px; }

    .tile-grid{ display:grid; gap:14px; grid-template-columns:repeat(2, minmax(220px, 1fr)); }
    @media (min-width:980px){ .tile-grid{ grid-template-columns:repeat(4, minmax(220px, 1fr)); } }
    .tile{
      background:var(--panel-2); border-radius:14px; padding:14px 16px; box-shadow:var(--shadow);
      display:flex; flex-direction:column; gap:6px; min-height:96px;
    }
    .tile .label{ color:var(--ink-2); font-size:13px; }
    .tile .value{ font-size:22px; font-weight:800; letter-spacing:.3px; }
    .tile .sub{ color:var(--muted); font-size:12px; }

    .chart-box{ background:var(--panel-2); border-radius:12px; padding:14px; box-shadow:var(--shadow); height:300px; display:flex; align-items:center; }
    .chart-box canvas{ width:100% !important; height:100% !important; }

    .download-btn{ display:inline-flex; align-items:center; gap:8px; margin-top:14px; padding:10px 16px; background:var(--blue); color:#fff; border:0; border-radius:10px; font-weight:700; cursor:pointer; transition:.2s; }
    .download-btn:hover{ filter:brightness(.95); transform:translateY(-1px); }

    .impact-wrap{ background:var(--panel-2); padding:14px; border-radius:14px; }
    #seoChart{ width:100%; height:320px !important; }
    .gridish{ background:var(--grid); border-radius:12px; }

    .richtext { color: var(--ink-2); line-height:1.6; }
    .richtext h3{ color: var(--ink); margin: 18px 0 8px; }
    .richtext p{ margin: 0 0 14px; }
    .richtext a { color: var(--blue); text-decoration:none; }
    .richtext a:hover { text-decoration:underline; }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>

<body>
  <h1>SEO + Analytics Report – bestimageresizer.com</h1>

  <div class="tabs">
    <div class="tab active" data-tab="keywords">Keyword Research</div>
    <div class="tab" data-tab="competitors">Competitor Analysis</div>
    <div class="tab" data-tab="impact">Impact Analysis</div>
    <div class="tab" data-tab="technical">Technical SEO</div>
    <div class="tab" data-tab="analytics">Analytics</div>
    <div class="tab" data-tab="nextsteps">Next Steps</div>
  </div>

  <!-- Technical -->
  <div id="technical" class="content">
    <h2>Technical SEO</h2>
    <ul id="technical-list"></ul>
  </div>

  <!-- Keyword Research -->
  <div id="keywords" class="content active">
    <h2>Keyword Research</h2>
    <div class="subtabs">
      <div class="subtab active" data-sub="transactional">Transactional</div>
      <div class="subtab" data-sub="informational">Informational</div>
      <div class="subtab" data-sub="navigational">Navigational</div>
      <div class="subtab" data-sub="commercial">Commercial</div>
    </div>

    <div id="transactional" class="subcontent active">
      <h3>Core function</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRmxxbbDjBgvoT3eaUlmK0od3fD1OCQvWETUnB4BReUZr_joyRd1hH4AR0NipwTO8buReLKIgnVDh50/pubhtml?gid=1764063307&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
      <h3>User intent</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRmxxbbDjBgvoT3eaUlmK0od3fD1OCQvWETUnB4BReUZr_joyRd1hH4AR0NipwTO8buReLKIgnVDh50/pubhtml?gid=1096589268&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
      <h3>Platform specific</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRmxxbbDjBgvoT3eaUlmK0od3fD1OCQvWETUnB4BReUZr_joyRd1hH4AR0NipwTO8buReLKIgnVDh50/pubhtml?gid=1070525027&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
    </div>

    <div id="informational" class="subcontent">
      <h3>Prepositions</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSqeNceKSuzCMCNskX1XSyTA-GFN3Xcx8ye2GqGZLMF00duVSdJcLyCccxq-fQwxyHIS9NJMN9z3inD/pubhtml?gid=689662762&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
      <h3>Questions V1</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSqeNceKSuzCMCNskX1XSyTA-GFN3Xcx8ye2GqGZLMF00duVSdJcLyCccxq-fQwxyHIS9NJMN9z3inD/pubhtml?gid=1707919888&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
      <h3>Questions V2</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSqeNceKSuzCMCNskX1XSyTA-GFN3Xcx8ye2GqGZLMF00duVSdJcLyCccxq-fQwxyHIS9NJMN9z3inD/pubhtml?gid=985068758&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
    </div>

    <div id="navigational" class="subcontent">
      <h3>Navigational big brands</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSYVLKWv9BOHHqE-Lj4izr5ne3lzL58ZT8DFZl5P7ap4HeHmCFxkuZ2H4mfTkHOmrzCyWXg0aj8TU1d/pubhtml?gid=313868502&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
      <h3>Navigational medium competition</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSYVLKWv9BOHHqE-Lj4izr5ne3lzL58ZT8DFZl5P7ap4HeHmCFxkuZ2H4mfTkHOmrzCyWXg0aj8TU1d/pubhtml?gid=775491972&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
    </div>

    <div id="commercial" class="subcontent">
      <h3>Commercial Comparison</h3>
      <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRmWxvrBMzEzrBQKc6vCGwfEZvUdRm9JWVxex4xqzVt5kqI_vab5Egoqao3BgUsZNKWrvYyCRvtQKQE/pubhtml?widget=true&amp;headers=false"></iframe>
    </div>
  </div>

  <!-- Impact -->
  <div id="impact" class="content">
    <h2>SEO Impact Analysis</h2>
    <div class="impact-wrap gridish">
      <canvas id="seoChart"></canvas>
    </div>
  </div>

  <!-- Competitors -->
  <div id="competitors" class="content">
    <h2>Competitor Analysis</h2>
    <div class="subtabs">
      <div class="subtab active" data-sub="comp-stats">Competitor Stats</div>
      <div class="subtab" data-sub="comp-gap">Keyword Gap (Birme vs. Others)</div>
      <div class="subtab" data-sub="comp-insights">SEO Insights</div>
    </div>

    <div id="comp-stats" class="subcontent active">
      <section class="comp-card">
        <div class="chart-box"><canvas id="birme-traffic"></canvas></div>
      </section>
    </div>

    <div id="comp-gap" class="subcontent">
      <h3>Keyword Gap: Birme vs. other competitors</h3>
      <div class="gridish" style="overflow:auto; border-radius:12px; padding:8px;">
        <table id="gap-table" style="width:100%; border-collapse:collapse; color:#eaeaea; font-size:14px;">
          <thead id="gap-thead"></thead>
          <tbody id="gap-tbody"></tbody>
        </table>
      </div>
    </div>

    <div id="comp-insights" class="subcontent">
      <iframe class="doc-iframe" src="https://docs.google.com/document/d/e/2PACX-1vQLEn_2HV2T3-O7Xidzca6kmNh-XdQbt1oiS-cNM1WmeIu1niWpZRUr7gLRVwa0MG7H7XwayI2X58n6/pub?embedded=true"></iframe>
    </div>
  </div>

  <!-- Analytics -->
  <div id="analytics" class="content">
    <h2>Analytics</h2>

    <div class="subtabs">
      <div class="subtab active" data-sub="analytics-overview">Overview</div>
      <div class="subtab" data-sub="analytics-campaigns">Campaigns</div>
      <div class="subtab" data-sub="analytics-retention">Retention</div>
      <div class="subtab" data-sub="analytics-stickiness">Stickiness</div>
      <div class="subtab" data-sub="analytics-funnel">Funnel</div>
      <div class="subtab" data-sub="analytics-reports">Reports</div>
      <div class="subtab" data-sub="analytics-insights">Insights</div>
    </div>

    <!-- Overview -->
    <div id="analytics-overview" class="subcontent active">
      <div class="tile-grid" id="analytics-tiles"></div>
      <div class="chart-box" style="margin-top:16px;"><canvas id="analytics-ratio-chart"></canvas></div>
      <h3 style="margin-top:22px;">Events: Event name (attached)</h3>
      <iframe class="doc-iframe" src="assets/Events_Event_name.pdf"></iframe>
    </div>

    <!-- Campaigns -->
    <div id="analytics-campaigns" class="subcontent">
      <div class="tile-grid" id="campaign-tiles"></div>
      <div class="chart-box" style="margin-top:16px;"><canvas id="campaign-compare-chart"></canvas></div>
      <h3 style="margin-top:22px;">Event count & retention by campaign (attached)</h3>
      <iframe class="doc-iframe" src="assets/Event count and retention by campaign.pdf"></iframe>
    </div>

    <!-- Retention -->
    <div id="analytics-retention" class="subcontent">
      <div class="tile-grid" id="retention-tiles"></div>
      <h3 style="margin-top:6px;">Overall Retention (Cohort)</h3>
      <iframe class="doc-iframe" src="assets/Overall retention.pdf"></iframe>
    </div>

    <!-- Stickiness -->
    <div id="analytics-stickiness" class="subcontent">
      <div class="tile-grid" id="stickiness-tiles"></div>
      <div class="chart-box" style="margin-top:16px;"><canvas id="stickiness-chart"></canvas></div>
      <h3 style="margin-top:22px;">User Stickiness Report</h3>
      <iframe class="doc-iframe" src="assets/User stickiness.pdf"></iframe>
    </div>

    <!-- Funnel -->
    <div id="analytics-funnel" class="subcontent">
      <h3>User Funnel</h3>
      <iframe class="doc-iframe" src="assets/User funnel.pdf"></iframe>
    </div>

    <!-- Reports (all five in one place) -->
    <div id="analytics-reports" class="subcontent">
      <h3>All Attached GA4 PDFs</h3>
      <iframe class="doc-iframe" src="assets/Events_Event_name.pdf"></iframe>
      <iframe class="doc-iframe" src="assets/Event count and retention by campaign.pdf"></iframe>
      <iframe class="doc-iframe" src="assets/Overall retention.pdf"></iframe>
      <iframe class="doc-iframe" src="assets/User stickiness.pdf"></iframe>
      <iframe class="doc-iframe" src="assets/User funnel.pdf"></iframe>
    </div>

    <!-- Insights placeholder -->
    <div id="analytics-insights" class="subcontent">
      <div class="richtext">
        <h3>Analysis & Next Steps (to fill)</h3>
        <p>Use the tiles above to call out: (1) sticky usage vs acquisition quality, (2) campaign-level retention deltas, (3) funnel bottlenecks (redirect→login vs login→resize), and (4) week-1 returners by campaign.</p>
      </div>
    </div>
  </div>

  <!-- Next Steps -->
  <div id="nextsteps" class="content">
    <h2>Next Steps</h2>
    <div id="nextsteps-content">
      <ul style="list-style:disc; padding-left:1.25rem; color:var(--ink-2); line-height:1.6;">
        <li><strong style="color:var(--ink)">Blog:</strong> Keep cadence focused on informational & commercial queries; link to the tool + platform pages.</li>
        <li><strong style="color:var(--ink)">Dynamic CMS Pages:</strong> Platform + industry variants; cross-linking strategy.</li>
        <li><strong style="color:var(--ink)">Campaign tuning:</strong> Use campaign retention deltas to reallocate spend/geo.</li>
        <li><strong style="color:var(--ink)">App onboarding:</strong> Lift Redirect→Login via copy + technical hardening.</li>
      </ul>
    </div>
  </div>

  <script>
    // Deep clone helper
    function deepClone(obj){
      try { return typeof structuredClone==='function' ? structuredClone(obj) : JSON.parse(JSON.stringify(obj)); }
      catch(e){ return JSON.parse(JSON.stringify(obj)); }
    }

    /* Demo charts */
    Chart.defaults.color = '#d8d8de';
    Chart.defaults.borderColor = 'rgba(255,255,255,.08)';

    function makeChart(id, type, labels, data, colors, opts={}){
      const el = document.getElementById(id); if(!el) return;
      const options = {
        responsive:true, maintainAspectRatio:false,
        plugins:{ legend:{ display:(opts.legend!==undefined)?opts.legend:(type!=='bar') }, tooltip:{enabled:true} },
        scales:{}
      };
      if(type!=='pie' && type!=='doughnut'){
        options.scales = { x:{grid:{color:'rgba(255,255,255,.06)'}}, y:{grid:{color:'rgba(255,255,255,.06)'}} };
      }
      new Chart(el.getContext('2d'),{
        type, data:{ labels, datasets:[{ label:opts.label||'', data, backgroundColor:colors, borderColor:colors, tension:.32, fill:(type==='line')?false:true, pointRadius:(type==='line')?3:0 }] }, options
      });
    }

    // Example impact chart
    makeChart('seoChart','bar',['Meta Titles','Alt Text','Schema','Page Speed'],[8,7,9,6],['#0a84ff','#30d158','#ffd60a','#ff453a'],{legend:false});

    // Keyword Gap table
    const GAP_CSV = 'assets/Birme%20keyword%20gap.csv';
    function renderGapTable(rows, limit=1000){
      const thead = document.getElementById('gap-thead');
      const tbody = document.getElementById('gap-tbody');
      if(!thead||!tbody||!rows||!rows.length) return;
      const cols = Object.keys(rows[0]);
      thead.innerHTML = '<tr>' + cols.map(c=>`<th style="text-align:left;padding:8px;border-bottom:1px solid rgba(255,255,255,.08)">${c}</th>`).join('') + '</tr>';
      tbody.innerHTML = rows.slice(0,limit).map(r=>(
        '<tr>'+cols.map(c=>`<td style="padding:8px;border-bottom:1px solid rgba(255,255,255,.06)">${r[c]??''}</td>`).join('')+'</tr>'
      )).join('');
    }
    function loadKeywordGap(){
      if(!document.getElementById('gap-table')) return;
      if(typeof Papa==='undefined'){ console.warn('PapaParse not loaded'); return; }
      Papa.parse(GAP_CSV,{download:true,header:true,skipEmptyLines:true,complete:(res)=>renderGapTable(res.data)});
    }

    /* ===================== Analytics Config ===================== */
    const CURRENT_ANALYTICS_FILE = ''; // if you host JSON later

    const ANALYTICS_DEFAULT = {
      period: "Sep 16 – Oct 20, 2025",
      sources: {
        wix: { page_view_users: 7127, app_redirect_users: 5826 },
        app: { login_users: 4851, export_images_users: 3111 }
      },
      // Stickiness inputs (set with real GA4 if you have them)
      stickiness: {
        dau: 1200,   // 1-day active users (example)
        wau: 4200,   // 7-day active users
        mau: 11000   // 30-day active users
      },
      // Cohort/retention highlight (optional, for tiles)
      retention: {
        week1_returners: 38,   // absolute count or %
        week2_returners: 5,
        week3_returners: 1
      },
      campaigns: {
        global: null, // {page_view_users, app_redirect_users, login_users, export_images_users}
        europe: null
      }
    };

    let ANALYTICS = deepClone(ANALYTICS_DEFAULT);

    async function loadAnalyticsJSON(){
      if(!CURRENT_ANALYTICS_FILE) return ANALYTICS;
      try{
        const res = await fetch(CURRENT_ANALYTICS_FILE);
        if(!res.ok) throw new Error('fetch failed');
        ANALYTICS = await res.json();
      }catch(e){
        console.warn('Analytics JSON load failed, using defaults.', e);
        ANALYTICS = deepClone(ANALYTICS_DEFAULT);
      }
      return ANALYTICS;
    }

    const fmt = (n)=> (n??0).toLocaleString();
    const pct = (n)=> (n*100).toLocaleString(undefined,{maximumFractionDigits:1})+'%';

    /* ---------- Overview tiles & ratios ---------- */
    function renderAnalyticsOverview(){
      const a = ANALYTICS;
      const pv = a.sources.wix.page_view_users||0;
      const ar = a.sources.wix.app_redirect_users||0;
      const lg = a.sources.app.login_users||0;
      const rz = a.sources.app.export_images_users||0;

      const ratios = {
        cta: pv? ar/pv : 0,
        redirectLogin: ar? lg/ar : 0,
        loginResize: lg? rz/lg : 0,
        pageResize: pv? rz/pv : 0
      };

      // DAU/WAU/MAU & stickiness
      const D = a.stickiness.dau||0, W=a.stickiness.wau||0, M=a.stickiness.mau||0;
      const dau_wau = W? D/W : 0;
      const wau_mau = M? W/M : 0;
      const dau_mau = M? D/M : 0;

      const tiles = [
        { label:'CTA click-through (Wix → App)', value:pct(ratios.cta), sub:`${fmt(ar)} / ${fmt(pv)} users` },
        { label:'Redirect → Login', value:pct(ratios.redirectLogin), sub:`${fmt(lg)} / ${fmt(ar)} users` },
        { label:'Login → Resize (init.)', value:pct(ratios.loginResize), sub:`${fmt(rz)} / ${fmt(lg)} users` },
        { label:'Page → Resize (overall)', value:pct(ratios.pageResize), sub:`${fmt(rz)} / ${fmt(pv)} users` },
        { label:'DAU / WAU', value:pct(dau_wau), sub:`${fmt(D)} / ${fmt(W)}` },
        { label:'WAU / MAU', value:pct(wau_mau), sub:`${fmt(W)} / ${fmt(M)}` },
        { label:'DAU / MAU', value:pct(dau_mau), sub:`${fmt(D)} / ${fmt(M)}` },
        { label:'30-day Active Users (MAU)', value:fmt(M), sub:'Users active in last 30 days' }
      ];

      const mount = document.getElementById('analytics-tiles');
      mount.innerHTML = tiles.map(t=>(
        `<div class="tile"><div class="label">${t.label}</div><div class="value">${t.value}</div><div class="sub">${t.sub}</div></div>`
      )).join('');

      makeChart('analytics-ratio-chart','bar',
        ['CTA','Redirect→Login','Login→Resize','Page→Resize','DAU/WAU','WAU/MAU','DAU/MAU'],
        [ratios.cta*100, ratios.redirectLogin*100, ratios.loginResize*100, ratios.pageResize*100, dau_wau*100, wau_mau*100, dau_mau*100],
        ['#0a84ff','#30d158','#ffd60a','#7a7aff','#0a84ff','#30d158','#ffd60a'],
        {legend:false}
      );
    }

    /* ---------- Campaign comparison ---------- */
    function renderAnalyticsCampaigns(){
      const c = ANALYTICS.campaigns||{};
      const g = c.global, e=c.europe;
      const tilesMount = document.getElementById('campaign-tiles');
      tilesMount.innerHTML = '';

      if(!g || !e){
        tilesMount.innerHTML = `<div class="tile" style="grid-column:1/-1">
          <div class="label">Campaign comparison</div>
          <div class="value">Waiting for segment data</div>
          <div class="sub">Add counts to <code>campaigns.global</code> and <code>campaigns.europe</code> in the JSON.</div>
        </div>`;
        return;
      }

      function ratios(x){
        const pv=x.page_view_users||0, ar=x.app_redirect_users||0, lg=x.login_users||0, rz=x.export_images_users||0;
        return { cta: pv?ar/pv:0, redirectLogin:ar?lg/ar:0, loginResize:lg?rz/lg:0, pageResize:pv?rz/pv:0 };
      }
      const rg=ratios(g), re=ratios(e);
      const rows = [
        { name:'CTA', g:rg.cta, e:re.cta },
        { name:'Redirect→Login', g:rg.redirectLogin, e:re.redirectLogin },
        { name:'Login→Resize', g:rg.loginResize, e:re.loginResize },
        { name:'Page→Resize', g:rg.pageResize, e:re.pageResize }
      ];

      tilesMount.innerHTML = rows.map(r=>(
        `<div class="tile"><div class="label">${r.name}</div><div class="value">Global ${pct(r.g)} · Europe ${pct(r.e)}</div></div>`
      )).join('');

      const ctx = document.getElementById('campaign-compare-chart').getContext('2d');
      new Chart(ctx,{type:'bar',data:{
        labels: rows.map(r=>r.name),
        datasets:[
          { label:'Global', data: rows.map(r=>r.g*100), backgroundColor:'#0a84ff' },
          { label:'Europe', data: rows.map(r=>r.e*100), backgroundColor:'#30d158' }
        ]},
        options:{ responsive:true, maintainAspectRatio:false, plugins:{legend:{display:true}} }
      });
    }

    /* ---------- Retention tiles (optional) ---------- */
    function renderRetentionTiles(){
      const r = ANALYTICS.retention||{};
      const target = document.getElementById('retention-tiles');
      target.innerHTML = [
        {label:'Week-1 Returners', value:fmt(r.week1_returners), sub:'Users returning in week 1'},
        {label:'Week-2 Returners', value:fmt(r.week2_returners), sub:'Users returning in week 2'},
        {label:'Week-3 Returners', value:fmt(r.week3_returners), sub:'Users returning in week 3'}
      ].map(t=>`<div class="tile"><div class="label">${t.label}</div><div class="value">${t.value}</div><div class="sub">${t.sub}</div></div>`).join('');
    }

    /* ---------- Stickiness area ---------- */
    function renderStickiness(){
      const s = ANALYTICS.stickiness||{};
      const D=s.dau||0, W=s.wau||0, M=s.mau||0;
      const tiles = [
        {label:'DAU', value:fmt(D), sub:'Daily active users'},
        {label:'WAU', value:fmt(W), sub:'7-day active users'},
        {label:'MAU', value:fmt(M), sub:'30-day active users'},
        {label:'DAU / MAU', value:pct(M?D/M:0), sub:'Stickiness (daily vs monthly)'}
      ];
      document.getElementById('stickiness-tiles').innerHTML = tiles.map(t=>(
        `<div class="tile"><div class="label">${t.label}</div><div class="value">${t.value}</div><div class="sub">${t.sub}</div></div>`
      )).join('');

      makeChart('stickiness-chart','line',
        ['DAU','WAU','MAU'],
        [D,W,M],
        ['#0a84ff'],
        {label:'Active users'}
      );
    }

    /* ---------- Tabs ---------- */
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.tab').forEach(tab=>{
        tab.addEventListener('click',()=>{
          document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
          document.querySelectorAll('.content').forEach(c=>c.classList.remove('active'));
          tab.classList.add('active');
          document.getElementById(tab.dataset.tab).classList.add('active');

          if(tab.dataset.tab==='analytics'){
            loadAnalyticsJSON().then(()=>{
              renderAnalyticsOverview();
              renderAnalyticsCampaigns();
              renderRetentionTiles();
              renderStickiness();
            });
          }
        });
      });

      document.querySelectorAll('.subtab').forEach(sub=>{
        sub.addEventListener('click',()=>{
          const wrap = sub.closest('.content'); if(!wrap) return;
          wrap.querySelectorAll('.subtab').forEach(s=>s.classList.remove('active'));
          wrap.querySelectorAll('.subcontent').forEach(sc=>sc.classList.remove('active'));
          sub.classList.add('active');
          const target = document.getElementById(sub.dataset.sub); if(target) target.classList.add('active');
          if(sub.dataset.sub==='comp-gap') loadKeywordGap();
        });
      });
    });

    // Small demo chart so Competitor tab isn’t empty
    makeChart('birme-traffic','line',['Feb','Mar','Apr','May','Jun','Jul','Aug'],[13787,14607,13907,14553,13090,19484,15760],['#0a84ff'],{label:'Organic Traffic'});
  </script>
</body>
</html>

